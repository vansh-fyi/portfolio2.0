<story-context id=".bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>1</epicId>
    <storyId>1.5</storyId>
    <title>Overlay Implementation</title>
    <status>drafted</status>
    <generatedAt>2025-11-17</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/sprint-artifacts/stories/1-5-overlay-implementation.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>developer</asA>
    <iWant>create the project display and chat overlays as conditionally rendered components</iWant>
    <soThat>they can be triggered by user actions</soThat>
    <tasks>
- [ ] **Task 1: Create Overlay Components** (AC: #1, #2)
  - [ ] Create a `ProjectOverlay.tsx` component.
  - [ ] Create a `ChatOverlay.tsx` component.
  - [ ] Style the components to match the existing `project-display.html` and `project-chat.html`.
- [ ] **Task 2: Implement State Management for Overlays** (AC: #1, #2, #3)
  - [ ] Set up a global state management store (e.g., Zustand) as recommended by the architecture.
  - [ ] Create state variables to manage the visibility of `ProjectOverlay` and `ChatOverlay`.
  - [ ] Create actions to open and close the overlays.
- [ ] **Task 3: Trigger Overlays from UI** (AC: #1, #2)
  - [ ] In the `Projects` component, add `onClick` handlers to the "See All Projects" button and project tabs to call the state management action that opens the `ProjectOverlay`.
  - [ ] In the `Hero` component, add an `onClick` handler to the "Ask Ursa" input to call the state management action that opens the `ChatOverlay`.
- [ ] **Task 4: Verify Performance** (AC: #3)
  - [ ] Use React DevTools to profile the application and ensure that the overlays do not cause unnecessary re-renders of the main page when they are not visible.
    </tasks>
  </story>

  <acceptanceCriteria>
1. **Given** the main application component, **when** the "See All Projects" button or a project tab is triggered, **then** the project display overlay is rendered.
2. **Given** the main application component, **when** the "Ask Ursa" input in the hero section is triggered, **then** the conversational chat overlay is rendered.
3. **And** the overlay components are rendered efficiently and do not impact the performance of the main page when not visible.
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/PRD.md</path>
        <title>Product Requirements Document</title>
        <section>Functional Requirements</section>
        <snippet>FR6: The "See All Projects" button and each of the five project tabs must trigger the display of the project gallery overlay. FR7: The "Ask Ursa" input in the hero section must trigger the display of the conversational chat overlay.</snippet>
      </doc>
      <doc>
        <path>docs/epics.md</path>
        <title>Epic Breakdown</title>
        <section>Story 1.5: Overlay Implementation</section>
        <snippet>As a developer, I want to create the project display and chat overlays as conditionally rendered components, so that they can be triggered by user actions. Technical Notes: Use React state to manage the visibility of the overlay components.</snippet>
      </doc>
      <doc>
        <path>docs/architecture.md</path>
        <title>Architecture</title>
        <section>Communication Patterns</section>
        <snippet>Frontend State Management: Use a lightweight state management library like Zustand for global state (e.g., overlay visibility, current project context). For local component state, use React's built-in useState and useReducer hooks.</snippet>
      </doc>
    </docs>
    <code>
      <artifact>
        <path>brownfield/project-display.html</path>
        <kind>html</kind>
        <symbol>body</symbol>
        <lines>all</lines>
        <reason>Reference for the structure and styling of the project display overlay.</reason>
      </artifact>
      <artifact>
        <path>brownfield/project-chat.html</path>
        <kind>html</kind>
        <symbol>body</symbol>
        <lines>all</lines>
        <reason>Reference for the structure and styling of the chat overlay.</reason>
      </artifact>
    </code>
    <dependencies>
      <dependency>
        <name>react</name>
        <version>^18.2.0</version>
        <reason>Core framework for the SPA.</reason>
      </dependency>
      <dependency>
        <name>zustand</name>
        <version>latest</version>
        <reason>Recommended library in the architecture document for global state management.</reason>
      </dependency>
    </dependencies>
  </artifacts>

  <constraints>
    <constraint>Use Zustand for global state management of overlay visibility.</constraint>
    <constraint>New overlay components should be placed in `portfolio-react-template/src/components/overlays/`.</constraint>
    <constraint>The implementation must preserve the existing UI and UX of the overlays.</constraint>
  </constraints>
  <interfaces></interfaces>
  <tests>
    <standards>Co-locate tests with the code they test (e.g., Component.test.tsx). Follow patterns established in the previous story (1.4).</standards>
    <locations>
      - `portfolio-react-template/src/components/**/__tests__`
      - `portfolio-react-template/src/state/**/__tests__`
    </locations>
    <ideas>
      - Write a component test to verify that the overlay components are not rendered by default.
      - Write a test to verify that the correct overlay is rendered when the corresponding state management action is called.
      - Write a test for the Zustand store to ensure the actions correctly update the state.
    </ideas>
  </tests>
</story-context>
